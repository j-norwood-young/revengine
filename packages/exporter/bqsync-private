#!/bin/sh

mongoexport -h "rfvengine1,rfvengine2,rfvengine3" -d revengine-prod -c readers -o ~/data/private_readers.csv --type csv --fields id,email,billing_phone,first_name,last_name,display_name,last_update,paying_customer,user_registered,wc_last_active,wp_capabilities.reader,wp_capabilities.author,wp_capabilities.administrator

/usr/bin/bq load --project_id nosaj-243304 --replace --skip_leading_rows=1 --allow_quoted_newlines=1 --source_format=CSV dailymaverick_secure.readers ~/data/private_readers.csv id:INT64,email:STRING,billing_phone:STRING,first_name:STRING,last_name:STRING,display_name:STRING,last_update:TIMESTAMP,paying_customer:BOOL,user_registered:TIMESTAMP,wc_last_active:TIMESTAMP,wp_capabilities_reader:BOOL,wp_capabilities_author:BOOL,wp_capabilities_administrator:BOOL

mongoexport -h "rfvengine1,rfvengine2,rfvengine3" -d revengine-prod -c woocommerce_subscriptions -o ~/data/woocommerce_subscriptions.csv --type csv --fields id,billing_interval,billing_period,cancelled_email_sent,created_via,customer_id,customer_ip_address,customer_note,customer_user_agent,date_completed,date_created,date_modified,date_paid,payment_method,products.0.name,products.0.total,schedule_next_payment,schedule_start,status,suspension_count,total,utm_source,utm_medium,utm_campaign,utm_term,device_type

/usr/bin/bq load --project_id nosaj-243304 --replace --skip_leading_rows=1 --allow_quoted_newlines=1 --source_format=CSV dailymaverick_secure.woocommerce_subscriptions ~/data/woocommerce_subscriptions.csv id:INT64,billing_interval:INT64,billing_period:STRING,cancelled_email_sent:BOOL,created_via:STRING,customer_id:INT64,customer_ip_address:STRING,customer_note:STRING,customer_user_agent:STRING,date_completed:TIMESTAMP,date_created:TIMESTAMP,date_modified:TIMESTAMP,date_paid:TIMESTAMP,payment_method:STRING,product_name:STRING,product_total:FLOAT64,schedule_next_payment:TIMESTAMP,schedule_start:TIMESTAMP,status:STRING,suspension_count:INT64,total:FLOAT64,utm_source:STRING,utm_medium:STRING,utm_campaign:STRING,utm_term:STRING,device_type:STRING

mongoexport -h "rfvengine1,rfvengine2,rfvengine3" -d revengine-prod -c woocommerce_orders -o ~/data/woocommerce_orders.csv --type csv --fields id,customer_id,customer_ip_address,customer_user_agent,date_completed,date_created,date_modified,date_paid,order_key,payment_method,products.0.name,total

/usr/bin/bq load --project_id nosaj-243304 --replace --skip_leading_rows=1 --allow_quoted_newlines=1 --source_format=CSV dailymaverick_secure.woocommerce_orders ~/data/woocommerce_orders.csv id:INT64,customer_id:INT64,customer_ip_address:STRING,customer_user_agent:STRING,date_completed:TIMESTAMP,date_created:TIMESTAMP,date_modified:TIMESTAMP,date_paid:TIMESTAMP,order_key:STRING,payment_method:STRING,product_name:STRING,total:FLOAT64

mongoexport -h "rfvengine1,rfvengine2,rfvengine3" -d revengine-prod -c woocommerce_memberships -o ~/data/memberships.csv --type csv --fields id,customer_id,status,start_date,end_date,cancelled_date,date_created,date_modified,order.id,order.total,order.date_paid,product.id,product.name,paused_date

/usr/bin/bq load --project_id nosaj-243304 --replace --skip_leading_rows=1 --allow_quoted_newlines=1 --source_format=CSV dailymaverick_secure.woocommerce_memberships ~/data/memberships.csv id:INT64,customer_id:INT64,status:STRING,start_date:TIMESTAMP,end_date:TIMESTAMP,cancelled_date:TIMESTAMP,date_created:TIMESTAMP,date_modified:TIMESTAMP,order_id:INT64,order_total:FLOAT64,order_date_paid:TIMESTAMP,product_id:INT64,product_name:STRING,paused_date:TIMESTAMP

mongoexport -h "rfvengine1,rfvengine2,rfvengine3" -d revengine-prod -c articles -o ~/data/articles.csv --type csv --fields id,urlid,author,date_published,date_modified,excerpt,title,type,tags.0,tags.1,tags.2,sections.0,sections.1,sections.2

/usr/bin/bq load --project_id nosaj-243304 --replace --skip_leading_rows=1 --allow_quoted_newlines=1 --source_format=CSV dailymaverick_secure.articles ~/data/articles.csv id:INT64,urlid:STRING,author:STRING,date_published:TIMESTAMP,date_modified:TIMESTAMP,excerpt:STRING,title:STRING,type:STRING,tag_1,tag_2,tag_3,section_1,section_2,section_3